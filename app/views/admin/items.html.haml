- item_type = @items.first.class.to_s.downcase
%h1.page-header Subject #{ item_type.titlecase }s for #{h @user.name}

- if flash[:notice]
  #error_wrapper
    #notice= flash[:notice]
%p
  Total #{ item_type.titlecase }s: #{@count}

%table#acts_pagey.table.table-striped
  %thead
    %tr
      %th Title
      %th Last Update
      %th Published
      %th Actions
  %tbody
    - for item in @items
      %tr
        %td
          - if item_type == 'page'
            = link_to h(item.item_name),{ :controller => "ica", :action => 'index', :id => item}
          - else
            = link_to h(item.item_name),{ :controller => "srg", :action => 'index', :id => item}
        %td
          = h item.updated_at
        %td
          - if item.published?
            = awesome_button polymorphic_path([item], action: :publish), 'lock', 'Add this module to the published list', '', method: :post, remote: true
          - else
            = awesome_button polymorphic_path([item], action: :publish), 'unlock', "Remove this #{ item_type } from the published list", '', method: :post, remote: true
        %td
          = link_to '', {:controller => "admin", :action => 'assign_guide', :id => item}, class: 'icon-user'
          |
          - if item_type == 'page'
            - if item.archived?
              = awesome_button polymorphic_path([item], action: :archive), 'check-empty', "Archive this #{ item_type }", '', method: :post, remote: true
            - else
              = awesome_button polymorphic_path([item], action: :archive), 'check', "Unarchive this #{ item_type  }", '', method: :post, remote: true
            |
          = link_to '', {:controller => "admin", :action => 'destroy_guide', :id => item}, class: 'icon-trash', confirm: 'Are you sure you want to delete this guide?', method: :delete