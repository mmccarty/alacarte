- edit |= false
- show |= false
- comments.each do |c|
  %div{:class => "comment_container #{cycle('grey', 'white', :name => "outer_colors")}"}
    - truncated_comment = truncate_comment(c.body, num_characters)
    .comment_title
      - if edit
        %span.help
          = link_to image_tag("icons/remove.png", :title => 'Delete this comment', :alt => 'delete', :border => 0), {:controller => :comment, |
            :action => :destroy,                                                                                                              |
            :id => c.id},                                                                                                                     |
            :confirm => "Are you sure you want to delete this comment?",                                                                      |
            :method => :delete                                                                                                                |
      - title = "Posted #{c.created_at.strftime("%m/%d")} by #{c.author_name}"
      - title += ", #{c.author_email}" if edit or show
      = h title
    .shown{:id => "truncated_comment_body#{c.id}"}
      = auto_link(truncated_comment)
    .hidden{:id => "comment_body#{c.id}"}
      = auto_link(truncate_comment(c.body, c.body.size))
    - if c.body.size > num_characters or c.body[0..num_characters].include?("\n")
      .show_more= link_to_function("read more", "swap('comment_body#{c.id}', 'truncated_comment_body#{c.id}');")
