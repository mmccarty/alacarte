%fieldset
  %h3.title
    = render :partial => '/tutorial/title_actions'
  %h4 Add Units
  - if flash[:error]
    #error_wrapper
      #list_error= flash[:error]
  = new_button 'Create New Unit'
  #new{:style => "display:none"}
    = form_tag :controller => 'unit', :action => 'create' do
      = error_messages_for 'unit'
      #vertical_inputs.index
        %h5 New Unit
        %span.more_help{:onmouseout => "delayhidetip();", :onmouseover => "fixedtooltip(MOD_TITLE_MSSG, this, event, '');"}= image_tag("icons/small_help.png", :alt => 'Tip', :border => 0)
        = content_tag :a, 'cancel', :onclick => "$('new').toggle();$('new_button').toggle();; return false;"
        <span #{%(class="required") if flash[:unit_title_error]}>
        %label{:for => "page_course_name"}
          Unit Name
          %span.required.more_help *
        = text_field 'unit', 'title',"size" => 45 , :value => flash[:unit_title]
        %span
          %label &nbsp;
          = submit_tag 'Create Unit'
        %br/
  - unless @units.size <1
    #product-list
      = form_tag :controller => 'unit', :action => 'add' do
        #table
          #mine
            #product-list
              %table.my_lists
                %thead
                  %tr
                    %th
                      = image_tag "spinner.gif", :id => "spinner_sort", :class => 'image', :alt => "Spinner", :style => 'display:none;'
                      Add
                      %span.more_help{:onmouseout => "delayhidetip();", :onmouseover => "fixedtooltip('Check the box next to the units you want to add to this tutorial or create a new unit to add.', this, event, '125');"}= image_tag("icons/small_help.png", :alt => 'Tip', :border => 0)
                    %th{:class => sort_th_class_helper("name")}
                      = sort_link_helper "Label", "name"
                    %th{:class => sort_th_class_helper("date")}
                      = sort_link_helper "Last Update", "date"
                - for unit in @units
                  %tr{:class => cycle('list-line-odd', 'list-line-even')}
                    %td.center{:width => "5%"}
                      - s = unit.id.to_s + unit.class.to_s
                      = check_box_tag(unit.id, unit.id,session[:added].include?(s) , :onclick => remote_function( :url => {:action => 'add_to_list', :uid => unit.id}))
                    %td{:class => sort_th_class_helper("name"), :width => "40%"}
                      = truncate(h(unit.title),:length => 45)
                    %td{:class => sort_th_class_helper("date"), :width => "10%"}
                      = unit.updated_at.to_date
          .pagination
            - if @units and @units.total_pages > 1
              %ul
                %li= will_paginate @units, :params => params.merge({:sort=> @sort}).except(:authenticity_token)
                %li= image_tag "spinner.gif", :id => "spinner_links", :class => 'image', :alt => "Spinner", :style => 'display:none;'
        = submit_tag 'Add to Tutorial', :class=> "submit"
  - else
    %p
      %b You currently have no Units.
  = render :partial => 'tutorial/side_bar'
